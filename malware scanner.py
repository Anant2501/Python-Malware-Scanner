import os
import hashlib

def scanner():
    #path of the directory. '.' for current directory
    path='.'

    #lists all files in the path
    a=os.listdir(path)

    #opens a text file of infected md5 hashes of malwares
    f=open("md5 hash.txt",'r') 
    f1=f.read().splitlines()

    a=0
    count=0

    #os.walk() generates the file names in a directory tree
    for root,dirs,files in os.walk(path): 
        for f in files:

            #counting number of files
            count+=1 
            
            # generates md5 hashes of each file
            result = hashlib.md5(f.encode('UTF-8')).hexdigest()

            # comparing md5 hashes of each file with infected ones
            if result in f1: 
                print ("Malware detected in:",f)
                #counter for malwares founds
                a+=1

    if (a==0):
        print("Scanned:",count,"files.No malwares found")

scanner()

